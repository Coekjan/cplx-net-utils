asn 4

# ip address

## rr 1

rtrr 1 @.4.1.2/24:g0/0/0 @.4.3.2/24:g0/0/1 @.4.11.1/24:g0/0/2
rtrr 1 @.4.5.1/24:g4/0/0 @.4.6.1/24:g4/0/1
rtrr 1 172.24.15.1/24:g4/0/3

## rr 2

rtrr 2 @.4.4.2/24:g0/0/0 @.4.2.2/24:g0/0/1 @.4.11.2/24:g0/0/2
rtrr 2 @.4.7.1/24:g4/0/0! @.4.8.1/24:g4/0/1

## br

rtbr 1 @.0.0.234/24:g0/0/0 @.4.2.1/24:g0/0/1 @.4.1.1/24:g0/0/2
rtbr 2 @.0.0.230/24:g0/0/0 @.4.3.1/24:g0/0/1 @.4.4.1/24:g0/0/2

## pe

rtpe 1 @.4.5.2/24:g0/0/0 @.4.9.1:g0/0/1 172.21.31.1/24:g0/0/2
rtpe 2 @.4.7.2/24:g0/0/0! @.4.9.2/24:g0/0/1 172.21.31.2/24:g0/0/2 172.23.31.1/24:g4/0/0
rtpe 3 @.4.6.2/24:g0/0/0 @.4.10.1/24:g0/0/1 172.22.31.1/24:g0/0/2
rtpe 4 @.4.9.2/24:g0/0/0 @.4.10.2/24:g0/0/1 172.22.31.2/24:g0/0/2

## ce

lsce 1 172.24.15.2/24:g0/0/1 172.24.@.2/28:g0/0/2
lsce 2 172.21.31.3/24:g0/0/1 172.21.@.9/29:g0/0/2,g0/0/3
lsce 3 172.21.31.4/24:g0/0/1 172.21.@.10/29:g0/0/2,g0/0/3
lsce 4 172.22.31.3/24:g0/0/1 172.22.@.9/29:g0/0/2,g0/0/3
lsce 5 172.22.31.4/24:g0/0/1 172.22.@.10/29:g0/0/2,g0/0/3
lsce 6 172.23.31.2/24:g0/0/1 172.23.@.9/29:g0/0/2


# ospf

ospf-rtrr 1,2 ^172.0.0.0/8
ospf-rtbr 1,2 ^@.0.0.0/16
ospf-rtpe 1,2,3,4 ^172.0.0.0/8

# mpls

mpls-rtrr 1,2 g0/0/0 g0/0/1 g0/0/2 g4/0/0 g4/0/1
mpls-rtbr 1,2 g0/0/0 g0/0/1 g0/0/2
mpls-rtpe 1,2,3,4 g0/0/0 g0/0/1

# bgp

bgp-rtrr 1,2 pe=1,2,3,4 br=1,2 ex=2{rtrr1,rtrr2}

bgp-rtbr 1,2 rr=1,2
bgp-rtbr 1 ex=2{@.0.0.233} prefer=false
bgp-rtbr 2 ex=2{@.0.0.231} prefer=true

bgp-rtpe 1,2,3,4 rr=1,2

bgp-rtrr-done 1,2
bgp-rtbr-done 1,2
bgp-rtpe-done 1,2,3,4

# vpn

vpn 1 6
vpn-rtrr 1,2 100:6 import=300:1,300:2,400:1,400:2,200:7 export=100:6

vpn 2 7
vpn-rtrr 1,2 200:7 import=300:1,300:2,400:1,400:2,100:6 export=200:7

vpn 3 1
vpn-rtrr 1,2 300:1 import=300:1,300:5,400:1,100:6,200:7 export=300:1

vpn 3 2
vpn-rtrr 1,2 300:2 import=300:2,300:5,400:2,100:6,200:7 export=300:2 

vpn 3 3
vpn-rtrr 1,2 300:3 import=300:3,400:3 export=300:3

vpn 3 5
vpn-rtrr 1,2 300:5 import=300:1,300:2,400:1,400:2 export=300:5

vpn 4 1
vpn-rtrr 1,2 400:1 import=300:1,300:5,400:1,100:6,200:7 export=400:1
vpn-rtpe 1,2 400:1 import=300:1,300:5,400:1,100:6,200:7 export=400:1
vpn-rtpe-bgp 1 172.21.31.3
vpn-rtpe-bgp 2 172.21.31.4
vpn-rtpe-bind 1,2 g0/0/2
vpn-lsce-bgp 2 172.21.31.1 172.21.@.8/29
vpn-lsce-bgp 3 172.21.31.2 172.21.@.8/29

vpn 4 2
vpn-rtrr 1,2 400:2 import=300:2,300:5,400:2,100:6,200:7 export=400:2
vpn-rtpe 3,4 400:2 import=300:2,300:5,400:2,100:6,200:7 export=400:2
vpn-rtpe-bgp 3 172.22.31.3
vpn-rtpe-bgp 4 172.22.31.4
vpn-rtpe-bind 3,4 g0/0/2
vpn-lsce-bgp 4 172.22.31.1 172.22.@.8/29 
vpn-lsce-bgp 5 172.22.31.2 172.22.@.8/29

vpn 4 3
vpn-rtrr 1,2 400:3 import=300:3,400:3 export=400:3
vpn-rtpe 2 400:3 import=300:3,400:3 export=400:3
vpn-rtpe-bgp 2 172.23.31.2
vpn-rtpe-bind 2 g4/0/0
vpn-lsce-bgp 6 172.23.31.1 172.23.@.8/29

vpn 4 4
vpn-rtrr 1,2 400:4 import=300:1,300:2,400:1,400:2 export=400:4
vpn-rtrr-bgp 1 172.24.15.2
vpn-rtrr-bind 1 g4/0/3
vpn-lsce-bgp 1 172.24.15.1 172.24.@.0/28
